# CrazyCodeGen

**CrazyCodeGen** is a modular, extensible PHP code generation framework. Unlike fluent-style builders, it focuses on composable expression trees and token-based rendering, designed to evolve with PHP versions.

## 🚀 Features

- Declarative structure for values, operators, and PHP constructs
- Fully pluggable rendering system (tokens, formatting, rules)
- Layered architecture for easy extension
- Token-based emission system — not tied to templates or hardcoded output
- PHP 8+ compatible, PSR-4 auto loading

## 📦 Installation

```bash
composer require crazycodr/crazycodegen
```

## 📐 Class generation example

```php
$baseModelBuilderType = new ClassTypeDef('App\\Common\\BaseModelBuilder');
$taxExemptionTypeType = new ClassTypeDef('App\\Checkout\\Taxes\\Models\\TaxExemptionType');

$modelProperty = new PropertyDef('model');

$createModelMethod = (new MethodDef('createModel'))
    ->setVisibility(VisibilityEnum::PROTECTED)
    ->setReturnType($taxExemptionTypeType)
    ->addInstruction(new ReturnOp(new NewOp(
        class: $taxExemptionTypeType,
        arguments: [
            [
                'identifier' => 'stub',
                'name' => 'stub',
            ]
        ],
    )));
$getMethod = (new MethodDef('get'))
    ->setReturnType($taxExemptionTypeType)
    ->addInstruction(new ReturnOp(ThisContext::to($modelProperty)));
$classDef = (new ClassDef('TaxExemptionTypeModelBuilder'))
    ->setNamespace('App\\Checkout\\Taxes\\Models')
    ->addImport($baseModelBuilderType)
    ->addImport($taxExemptionTypeType)
    ->setDocBlock([
        'This file was generated using a framework.',
        'Do not edit this file as the content will be replaced automatically the next time someone will run the generate command.',
    ])
    ->setExtends($baseModelBuilderType)
    ->addMethod($createModelMethod)
    ->addMethod($getMethod);

$rules = new RenderingRules();
$rules->docBlocks->lineLength = 125;

echo $classDef->getTokens(new RenderContext(), $rules);
```

## 📚 Documentation

- [Structure definitions (Classes, methods, properties, etc)](docs/Using/Definitions/Structures/StructureDefinitions.md)
- [Type definitions](docs/Using/Definitions/TypeDefinitions.md)
- [Value definitions](docs/Using/Definitions/ValueDefinitions.md)
- [Expressions](docs/Using/Expressions.md)
- [Instructions](docs/Using/Instructions.md)

## 🧪 Tests

Run tests with:

```bash
vendor/bin/phpunit
```

## 📝 License

MIT (or GPL, TBD)
